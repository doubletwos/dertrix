@model Dertrix.Models.RegisteredUser
<form id="GuardianForm">
	@Html.AntiForgeryToken()
	@{
		HtmlHelper.UnobtrusiveJavaScriptEnabled = false;
	}
	<div class="form-horizontal">
		<h4>Parent / Guardian</h4>
		<hr />
		@Html.ValidationSummary(true, "", new { @class = "text-danger" })
		@Html.HiddenFor(model => model.RegisteredUserId)
		<div class="form-group">
			@Html.LabelFor(model => model.FirstName, htmlAttributes: new { @class = "control-label col-md-2" })
			<div class="col-md-10">
				@Html.EditorFor(model => model.FirstName, new { htmlAttributes = new { @class = "form-control" } })
				@Html.ValidationMessageFor(model => model.FirstName, "", new { @class = "text-danger" })
			</div>
		</div>
		<div class="form-group">
			@Html.LabelFor(model => model.LastName, htmlAttributes: new { @class = "control-label col-md-2" })
			<div class="col-md-10">
				@Html.EditorFor(model => model.LastName, new { htmlAttributes = new { @class = "form-control" } })
				@Html.ValidationMessageFor(model => model.LastName, "", new { @class = "text-danger" })
			</div>
		</div>
		<div class="form-group">
			@Html.LabelFor(model => model.Email, htmlAttributes: new { @class = "control-label col-md-2" })
			<div class="col-md-10">
				@Html.EditorFor(model => model.Email, new { htmlAttributes = new { @class = "form-control" } })
				@Html.ValidationMessageFor(model => model.Email, "", new { @class = "text-danger" })
			</div>
		</div>
		<div class="form-group">
			@Html.LabelFor(model => model.Telephone, htmlAttributes: new { @class = "control-label col-md-2" })
			<div class="col-md-10">
				@Html.EditorFor(model => model.Telephone, new { htmlAttributes = new { @class = "form-control" } })
				@Html.ValidationMessageFor(model => model.Telephone, "", new { @class = "text-danger" })
			</div>
		</div>
		@{
			if ((int)Session["OrgType"] == 3 || (int)Session["OrgType"] == 5)
			{
				@Html.DropDownList("PrimarySchoolUserRoleId", null, "Please Select", new { @id = "PrimarySchoolUserRoleId", @class = "form-control" })

			}
		}
		@{
			if ((int)Session["OrgType"] == 2 || (int)Session["OrgType"] == 5)
			{
				@Html.DropDownList("SecondarySchoolUserRoleId", null, "Please Select", new { @id = "SecondarySchoolUserRoleId", @class = "form-control" })
			}
		}

		<div class="modal-footer">
			<input type="submit" value="Add" class="RegUserOrgButtonColour" id="addGuardian" />
			<input type="reset" value="Cancel" class="RegUserOrgButtonColour" data-dismiss="modal" />
		</div>
	</div>
</form>

<script>
	$(document).ready(function () {
		$("#PrimarySchoolUserRoleId").hide();
		$("#SecondarySchoolUserRoleId").hide();
		$("#PrimarySchoolUserRoleId").val("5");
		$("#SecondarySchoolUserRoleId").val("5");




		$('#GuardianForm').validate({
			errorClass: 'help-block animation-slideDown', // You can change the animation class for a different entrance animation - check animations page
			errorElement: 'div',
			errorPlacement: function (error, e) {
				e.parents('.form-group > div').append(error);
			},
			highlight: function (e) {
				$(e).closest('.form-group').removeClass('has-success has-error').addClass('has-error');
				$(e).closest('.help-block').remove();
			},
			success: function (e) {
				e.closest('.form-group').removeClass('has-success has-error');
				e.closest('.help-block').remove();
			},
			rules: {
				'FirstName': {
					required: true,
				},
				'LastName': {
					required: true,
				},
				'Email': {
					required: true,
				}
			},
			messages: {
				'FirstName': 'First name is required',
				'LastName': 'Last name is required',
				'Email': 'Please enter email address',
			}
		});




		$("#addGuardian").on("click", function () {
			if ($("#GuardianForm").valid())
			{
				var data = $("#GuardianForm").serialize();
				$.ajax({
					type: "POST",
					url: "/RegisteredUsers/Create",
					data: data,
					success: function (response) {
						alert("New Guardian Added");
						$("#myModal").modal("hide");
						$("#GuardianForm")[0].reset();
						window.location.reload();
					}
				})
			}
		})
	})
</script>






